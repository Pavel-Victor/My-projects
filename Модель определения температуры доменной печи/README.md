# Задача и предоставленные данные

Необходимо было построить модель для предсказания конечной температуры стали в ковше при доводке её до необходимого состава и состояния. 

В ходе производства контролируются и измеряются следующие параметры:
- Используемая в процессе электрическая мощность
- Начальная температура ковша
- Используемые добавки 
- Время технологического процесса
- Конечная температура ковша, как признак, который надо предсказать

## Предоставленные данные

В качестве исходных данных были предоставлены несколько таблиц, которые содержали измерения, выполненные на заводе. 

Предоставлены несколько таблиц. Все таблицы имеют одно общее объединяющее поле key, которое является номером отдельной плавки, отдельного ковша. Таблицы содержат следующие данные:
- data_arc -  содержит интервалы нагрева ковша по времени с активной и реактивной мощностью. На каждый key имеется несколько записей.
- data_temp - содержит время и температуру ковша в определенное время. На каждый key имеется несколько записей
- data_gas содержит информацию об обработке ковша газом. На каждый key имеет одну запись
- data_bulk - содержит перечень добавок и их количество по каждому ковшу. На каждый key имеется одна запись
- data_bulk_time  содержит время внесения добавок . На каждый key имеется одна запись.
- data_wire - содержит перечень добавок проволоки. На каждый key имеется одна запись.
- data_wire_time  содержит время внесения проволоки . На каждый key имеется одна запись.



#### План работы:  
- Провести исследовательский анализ данных:
    - Посмотреть на распределение исходных данных, решить вопросы, связанные с некорректностью данных(пропуски, выбросы)
    - Проанализировать порядок событий в производственном процессе
    - Исключить партии, которые не имеют последнего замера темпиратуры, либо первый замер соответствует последнему, либо замеры отсутствуют 
    - Оставить только события, которые находятся в промежутке между первым и последним замерами
- Подобрать признаки, на которых будет обучаться модель:
    - Сгенерировать ряд признаков
    - Проверить признаки на мультиколлинеарность, исключить лишние
    - Провести масштабирование признаков
- Построить модель, которая предскажет температуру стали:
    - Сформировать обучающую, валидационную и тестовую выборки
    - Выбрать несколько моделей и проверить их эффективность на валидационной выборке с помощью показателя эффективности MAE
    - Эффективность лучшей модели проверить на тестовой выборке


### Ход выполнения работы и её особенности.

В ходе работы обнаружилось, что данные недостаточно точные и полные. Пришлось много провести анализ, какие данные необходимо было просто удалить, а какие данные можно было восстановить тем или иным методом.

Данные были предоставлены в виде разрозненных таблиц. После анализа, чистки и восстановления данных, они были объединены в одну таблицу.

Итоговая таблица была проверена на мультиколениарность и по итогам значительно прорежена. Это в дальнейшем позволило экономить вычислительный ресурс. 

# Построение  и обучение модели

В ходе этого этапа опробуем следующие модели:
- LinearRegression
- CatBoost
- LihtGBM
- RandomForest

Подбор параметров произведем двумя способами: ручным подбором параметров и с использованием метода GridSearchCV. По итогам была выбрана лучшая модель.

Итоги размещены в таблице



|Модель|Результат на тестовых данных|
| :---| :---:| 
|Линейная регрессия|6.32|
|CatBoost|6.22|
|LightGBM|6.12|
|LightGBM совместно с GridSearchCV|6.54|
|RandomForest совместно с GridSearchCV|6.52|
|Линейная регрессия с нормализацией|6.32|
|CatBoost с нормализацией|6.22|
|LightGBM совместно с GridSearch с нормализацией|6.54|



Согласно задания, требовалась метрика предсказания MAE на тестовом наборе не более 6,3. Эти показатели были достигнуты при использовании двух моделей.
